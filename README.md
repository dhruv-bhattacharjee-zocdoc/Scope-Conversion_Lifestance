# Scope Conversion Lifestance - Documentation

## Overview
This set of codes automates the transposition and transformation of provider and location data from a raw input Excel file into a structured output Excel file, using a template and a series of Python scripts. The workflow extracts, cleans, and validates data, and applies dropdowns and formulas for downstream use.

## Main Workflow
1. **Input File**: `Excel Files/Input.xlsx` (raw provider/location data)
2. **Template File**: `Excel Files/New Business Scope Sheet - Practice Locations and Providers.xlsx` (structure and validation references)
   - **Note:** If you need to change the structure, columns, or validation rules for the output, update this template file. All output files will follow its structure and rules.
3. **Main Script**: `_main_1.py` orchestrates the process:
   - Extracts data using various helper scripts (see below)
   - Copies template structure
   - Populates the output file
   - Calls `Location.py` to generate the Location sheet
   - Adds dropdowns and validations
   - Produces `Excel Files/Output.xlsx`

## Python Scripts Summary
| File                        | Purpose |
|-----------------------------|---------|
| `_main_1.py`                | Main orchestrator: runs the full workflow, calls all extract/transform scripts, manages output file creation. |
| `Location.py`               | Generates the Location sheet, standardizes addresses, copies relevant columns, and applies address cleaning. |
| `Name.py`                   | Extracts provider names and gender from input. |
| `Npi.py`                    | Extracts NPI numbers from input. |
| `Headshot.py`               | Extracts headshot URLs from input. |
| `professional_suffix.py`    | Extracts and applies professional suffixes (e.g., MD, PhD). |
| `Specialty.py`              | Extracts specialties and applies specialty dropdowns. |
| `PatientsAccepted.py`       | Extracts and sets dropdowns for patient types accepted (Adult, Pediatric, Both). |
| `Education.py`              | Extracts education and school information. |
| `Professional_statement.py` | Extracts provider bios/statements. |
| `Board_certification.py`    | Extracts board certifications and subspecialties. |
| `Boardcertification.py`     | (Duplicate/variant) Extracts board certifications. |
| `optoutrating.py`           | Adds dropdown for 'Opt Out of Ratings'. |
| `ESF.py`                    | Adds dropdown for 'Enterprise Scheduling Flag'. |
| `Langauge.py`               | Extracts languages spoken. |
| `provider_dropdowns.py`     | Applies dropdowns and formulas to the Provider sheet. |
| `specialtydropdown.py`      | Adds specialty dropdowns using validation references. |
| `_status _check.py`         | Checks the status and completeness of the output file, validates columns. |
| `Searchname.py`             | (Empty/unused) |

## Excel Files Summary
| File Name                                               | Purpose |
|---------------------------------------------------------|---------|
| `Input.xlsx`                                            | Raw input data from Lifestance. |
| `New Business Scope Sheet - Practice Locations and Providers.xlsx` | Template for output structure and validation. |
| `C1 Street Suffix Abbreviations.xlsx`                   | Reference for standardizing street suffixes. |
| `Output.xlsx`                                           | Final output file generated by the workflow. |

## How the Scripts Interact
- `_main_1.py` is the entry point. It imports and calls functions from all other scripts to extract, clean, and write data.
- Each helper script (e.g., `Name.py`, `Npi.py`, etc.) focuses on a specific data field or transformation.
- `Location.py` is called as a subprocess to generate the Location sheet after the main Provider sheet is created.
- Dropdowns and data validations are applied by scripts like `provider_dropdowns.py`, `specialtydropdown.py`, `optoutrating.py`, and `ESF.py`.
- The status of the output is checked by `_status _check.py`.

## Notes
- All scripts expect the input and template files to be in the `Excel Files/` directory.
- The output is written to `Excel Files/Output.xlsx`.
- Some scripts (e.g., `Boardcertification.py`) may be legacy or duplicates; prefer the main variant unless otherwise needed.

---

## How to Generate the Output File

To obtain the final output file (`Output.xlsx`), follow these steps:

### Prerequisites
- Ensure you have Python 3.x installed on your system.
- Install required Python packages. Run:
  ```bash
  pip install -r requirements.txt
  ```
- Place the following files in the `Excel Files/` directory:
  - `Input.xlsx` (input data from Lifestance)
  - `New Business Scope Sheet - Practice Locations and Providers.xlsx` (template for output structure and validation)
  - `C1 Street Suffix Abbreviations.xlsx` (reference for standardizing street suffixes)

### Steps to Run
1. Open a terminal or command prompt.
2. Navigate to the project directory:
   ```bash
   cd "<path-to-project-directory>"
   ```
3. Run the main script:
   ```bash
   python _main_1.py
   ```
4. After successful execution, the output file will be created as:
   - `Excel Files/Output.xlsx`

### What to Do After Generating the Output File
- Open `Excel Files/Output.xlsx` to review the results.
- Verify that all required data, dropdowns, and validations are present in the Provider, ValidationAndReference, and Location sheets.
- If further edits or customizations are needed, you can update the output file directly in Excel using the dropdowns.
- If you need to re-run the process with new data or a new template, replace `Input.xlsx` or the template file and repeat the steps above.
